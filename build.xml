<project name="communiiity" default="package" basedir=".">
    <property file="build.properties" />
    
    <target name="package" depends="version, zipPackageDevsite">
        <echo>Building the full codebase</echo>
    </target>

    <target name="version" if="version.file">
        <propertyfile file="version.properties">
            <entry key="build" type="int" operation="+" default="0" />
        </propertyfile>
    
        <copy overwrite="true" file="${version.stub}" toFile="${version.file}" />
    
        <replace file="${version.file}" propertyFile="version.properties">
            <replacefilter token="@version@" property="version" />
            <replacefilter token="@build@" property="build" />
        </replace>
    </target>

    <target name="cleanupPackaging">
        <delete dir="${package.dir}/" />
    </target>
    
    <target name="zipPackage" depends="cleanupPackaging">
        <zip destfile="${package.dir}/${package.name}" basedir="${basedir}" />
    </target>
    
    <target name="zipPackageDevsite" depends="cleanupPackaging">
        <zip destfile="${package.dir}/${package.name}" basedir="${basedir}/devsite/" />
    </target>

</project>
